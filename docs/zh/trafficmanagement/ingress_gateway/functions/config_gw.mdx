---
weight: 20
sourceSHA: 876ca468db6cda90d4d1dab44290670ad2ba51f0f8b4bf9812dd1876448666d0
---

# 网关配置

## 引言

网关配置定义了具有网络暴露参数的逻辑网关，以便于：

- 为服务网格建立标准化的入口点
- 启用协议感知的流量监听
- 与现有的 DNS/证书基础设施集成
- 促进流量路由规则绑定

核心价值：统一的南北向流量入口管理

## 特性

- 多协议端口定义 (HTTP/HTTPS/TCP)
- 基于主机的流量过滤
- TLS 终止的 SNI 配置
- 与平台管理的域名的 DNS 集成

## 优势

**安全性**：强制要求 HTTPS 证书  
**灵活性**：支持通配符主机 (`*`)  
**合规性**：要求 2048 位的最小密钥长度  
**可观察性**：内置路由指标集成  

## 创建网关配置

### 第一步：访问配置界面

1. 导航至：**服务网格** > **网关**
2. 选择目标入口网关
3. 打开 **网关配置** 标签
4. 点击 **创建网关配置**

### 第二步：核心参数设置

```yaml
apiVersion: networking.istio.io/v1beta1
kind: Gateway
metadata:
  name: main-gateway
spec:
  servers:
  • port:
      number: 443
      protocol: HTTPS
    hosts:
    ◦ "www.example.com"
```

| 参数      | 必填     | 约束条件                   |
| --------- | -------- | -------------------------- |
| 命名空间  | 是       | 预定义的网关位置          |
| 端口      | 是       | 必须匹配网关部署          |
| 主机      | 是       | 有效的域名或 `*` 通配符   |

### 第三步：协议特定规则

**HTTPS 要求**：

```bash
# 证书验证检查
openssl x509 -text -in example.crt | grep 'Key Usage' -A1
```

- 必须使用平台注册的域名
- 证书密钥长度 ≥ 2048 位

**TCP 局限性**：

- 仅支持通配符主机 (`*`)
- 无 TLS 终止能力

## 配置管理

### 创建后操作

1. 项目管理员可以：
   - 查看网关配置
   - 创建相关的路由规则
   - 监控流量指标
2. DNS 验证：

```bash
dig +short <configured-domain> @8.8.8.8
```

### 更新约束

- 创建后端口协议无法修改
- 主机更改需要证书重新验证
- 命名空间绑定是不可变的
