---
weight: 15
i18n:
  title:
    en: Installation
    zh: 安装
sourceSHA: dafe2339c1ed2579a179c5a32a18e0c8269b51c39a1266f375a534ecf9d9d69c
---

# 安装

本文将使用两个位于不同 VPC（虚拟私有云）的 AWS EKS（Amazon Elastic Kubernetes Service）集群 c1 和 c2 作为示例，说明如何构建多集群、多网络的服务网格。

:::note

为了演示，本文仅选择两个集群来构建网格。在实际操作中，您可以根据需要向服务网格添加更多符合前提条件的集群。

:::

## 前提条件

- 对于私有云，确保所有集群上都配置了 Kubernetes LoadBalancer（例如，MetaLB），以为部署在集群上的 Istio 网关提供负载均衡能力。
- 所有集群均已连接到平台。
- 已通过 <ExternalSiteLink name="acp" href="/observability/monitor/functions/install_monitor.html#install-the-acp-monitoring-with-victoriametrics-plugin" children="部署监控组件" /> 将监控组件部署在所有集群上，包括 **VictoriaMetrics**。为了确保来自多个集群的监控数据能够聚合，请确保要加入网格的多个集群的监控数据可以收集到同一 VictoriaMetrics 中心，并使用相同的数据查询地址。
  **注意**：经过测试，**VictoriaMetrics** 对 **多主架构**的服务网格支持良好。如需其他监控解决方案的支持，请联系技术支持。
- 所有集群中的 **控制节点** 和 **负载均衡设备**（如有）必须开放 `6443` 端口以供 kube-apiserver 使用，负载均衡设备的 `6443` 端口必须将流量转发到控制节点的 `6443` 端口。
- 请确保集群的 Kubernetes 版本与平台支持的 Istio 版本兼容。有关详细信息，请参见 [Istio 支持的 Kubernetes 版本](https://istio.io/latest/docs/releases/supported-releases/)。

## 创建服务网格

选择一个预设的集群并创建服务网格。

创建网格时，按照以下方式配置相应的参数，并根据需要配置其他参数：

- 为网格部署 Istio。
- 在 **网格架构** 中选择 `多集群`。
- 在 **网络类型** 中选择 `多网络`。
  **注意**：平台将自动为所有加入网格的集群部署东西向流量网关，连接集群之间的网络。
- 在 **监控系统** 中与 `平台` 提供的监控组件进行集成。

## 添加集群

1. 在左侧导航栏中，点击 **服务网格** > **网格**。
2. 点击要添加的集群的 ***服务网格名称***。
3. 在 **网格详情** 标签下的 **网格部署** 部分，点击 **添加集群**。
4. 在 **基本信息** 部分，选择要加入服务网格的集群。
5. 根据实际部署需求，配置集群级别的网格配置和组件。
6. 点击 **添加**。

   **注意**：

   - 成功添加后，系统将依次在集群上部署与服务网格相关的组件。点击 <img src="./assets/show_status.png" style={{display: "inline", verticalAlign: "middle"}} /> 在 **网格部署** 部分查看部署进度。

   - 添加集群后，网格的全局配置（监控系统、Elasticsearch 集成配置）将自动同步到新添加的集群。
