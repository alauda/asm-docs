---
weight: 10
sourceSHA: 5388679604a5f95d679d3ae1b0ceae3b66fcb6570aa9d70d932c24a127abd1c7
---

# 创建 EnvoyFilter

EnvoyFilter 提供了一种机制，用于自定义由 Istio Pilot 生成的 Envoy 配置。通过在平台上创建 EnvoyFilter 并将其绑定到集群中的服务，您可以通过 EnvoyFilter 将自定义功能分发到服务网格下的服务。

:::danger 废弃通知

**为何废弃？**

EnvoyFilter 是一个高风险特性，可能会影响业务操作。由于其与底层 Envoy API 的紧密耦合，无法保证向后兼容性。此外，EnvoyFilter 装补对 Istio 生成的 Envoy 配置格式高度敏感。Istio 配置的任何变化都可能导致使用 EnvoyFilter 的应用程序出现故障。因此，产品将在即将发布的版本中废弃 EnvoyFilter 功能。

**产品支持策略**

废弃 EnvoyFilter 的目的是为了防止客户独立编写和维护 EnvoyFilters，从而降低兼容性问题的风险。如果客户有可以通过 EnvoyFilter 解决的需求，应联系产品开发团队。开发团队将提供必要的解决方案，并确保解决与 EnvoyFilter 的任何兼容性问题。

:::

## 操作步骤

在创建 EnvoyFilter 时，您可以为当前项目中服务网格支持的不同版本的 Istio 添加 EnvoyFilter 资源，以便一个 EnvoyFilter 可以兼容多个 Istio 版本。

1. 在左侧导航栏中，点击 **服务网格** > **EnvoyFilter**。

2. （可选）点击顶部导航栏上的 **服务网格** 进行切换。

3. 点击 **创建 EnvoyFilter**。

4. 请参照以下说明配置相关参数。

| 参数                           | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **集群的集群**                 | 由服务网格管理的集群，成功创建的 EnvoyFilter 只能将能力分发到运行在所选集群上的服务。                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **配置信息**                   | 适配平台支持的用于 Istio 版本的 EnvoyFilter 的结构信息。EnvoyFilter 的结构因不同版本的 Istio 而异。请参考 [官方文档](https://istio.io/latest/docs/reference/config/networking/envoy-filter/) 进行编写。 <br />**注意**：在升级服务网格的 Istio 版本时，为了避免影响正常业务操作，请在升级前创建一个与更高版本的 Istio 兼容的 EnvoyFilter。升级后，服务将自动绑定到与升级版本兼容的 EnvoyFilter。                           |

8. 在确认信息无误后，点击 **创建**。

## 接下来

成功创建 EnvoyFilter 后，可以通过 [绑定服务](./bind_a_service.mdx) 将此 EnvoyFilter 的能力分配给服务网格中的服务。
