---
weight: 10
sourceSHA: 5388679604a5f95d679d3ae1b0ceae3b66fcb6570aa9d70d932c24a127abd1c7
---

# 创建 EnvoyFilter

EnvoyFilter 提供了一种机制，用于自定义 Istio Pilot 生成的 Envoy 配置。通过在平台上创建 EnvoyFilter 并将其绑定到集群中的服务，您可以通过 EnvoyFilter 将自定义功能分发到服务网格下的服务。

:::danger 弃用通知

**为什么要弃用？**

EnvoyFilter 是一个高风险特性，可能会影响业务运营。由于它与底层 Envoy API 的紧密耦合，因此无法保证向后兼容性。此外，EnvoyFilter 补丁对于 Istio 生成的 Envoy 配置格式非常敏感。Istio 配置的任何更改都可能会破坏使用 EnvoyFilter 的应用程序。因此，产品将在即将发布的版本中弃用 EnvoyFilter 特性。

**产品支持策略**

弃用 EnvoyFilter 的目的是避免客户独立编写和维护 EnvoyFilters，从而减少兼容性问题的风险。如果客户有可以通过 EnvoyFilter 解决的需求，应联系产品开发团队。开发团队将提供必要的解决方案，并确保与 EnvoyFilter 的任何兼容性问题得到解决。

:::

## 步骤

在创建 EnvoyFilter 时，您可以为当前项目中服务网格支持的不同兼容版本的 Istio 添加 EnvoyFilter 资源，以便一个 EnvoyFilter 可以兼容多个 Istio 版本。

1. 在左侧导航栏中，点击 **服务网格** > **EnvoyFilter**。

2. （可选）在顶部导航栏中点击 **服务网格** 进行切换。

3. 点击 **创建 EnvoyFilter**。

4. 请参考以下说明配置相关参数。

| 参数                           | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| ------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **集群中的集群**              | 由服务网格管理的集群，成功创建的 EnvoyFilter 只能将功能分发到运行在选定集群中的服务。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **配置说明**                  | 适配平台支持的 Istio 版本的 EnvoyFilter 结构信息。EnvoyFilter 的结构因不同的 Istio 版本而异。请参考 [官方文档](https://istio.io/latest/docs/reference/config/networking/envoy-filter/) 进行编写。 <br />**注意**：在升级服务网格的 Istio 版本时，为避免影响正常业务运营，请在升级前创建一个与更高版本的 Istio 兼容的 EnvoyFilter。升级后，服务将自动绑定到与升级版本兼容的 EnvoyFilter。 |

8. 确认信息无误后，点击 **创建**。

## 接下来做什么

成功创建 EnvoyFilter 后，可以通过 [绑定服务](./bind_a_service.mdx) 将此 EnvoyFilter 的功能分发到服务网格中的服务。
