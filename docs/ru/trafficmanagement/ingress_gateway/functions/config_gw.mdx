---
weight: 20
sourceSHA: 876ca468db6cda90d4d1dab44290670ad2ba51f0f8b4bf9812dd1876448666d0
---

# Конфигурация шлюза

## Введение

Конфигурация шлюза определяет логические шлюзы с параметрами сетевого подключения для:

- Установления стандартизированных входных точек для сервисной сетки
- Обеспечения прослушивания трафика с учетом протоколов
- Интеграции с существующей инфраструктурой DNS/сертификатов
- Обеспечения привязки правил маршрутизации трафика

Основное значение: Упрощенное управление входными точками для трафика север-юг

## Возможности

- Определения много-протокольных портов (HTTP/HTTPS/TCP)
- Фильтрация трафика на основе хостов
- Настройка SNI для терминации TLS
- Интеграция DNS с управляемыми платформой доменами

## Преимущества

**Безопасность**: Принудительное использование сертификатов для HTTPS  
**Гибкость**: Поддержка хостов с подстановочными знаками (`*`)  
**Соответствие**: Минимальная длина ключа 2048 бита  
**Наблюдаемость**: Встроенная интеграция с метриками маршрутизации

## Создание конфигурации шлюза

### Шаг 1: Доступ к интерфейсу конфигурации

1. Перейдите в: **Service Mesh** > **Gateway**
2. Выберите целевой входной шлюз
3. Откройте вкладку **Gateway Configuration**
4. Нажмите **Create Gateway Configuration**

### Шаг 2: Настройка основных параметров

```yaml
apiVersion: networking.istio.io/v1beta1
kind: Gateway
metadata:
  name: main-gateway
spec:
  servers:
  • port:
      number: 443
      protocol: HTTPS
    hosts:
    ◦ "www.example.com"
```

| Параметр  | Обязательно | Ограничения                          |
|-----------|-------------|--------------------------------------|
| Namespace | Да          | Предопределенное местоположение шлюза |
| Port      | Да          | Должен соответствовать развертыванию шлюза |
| Hosts     | Да          | Действительный домен или подстановочный знак `*`  |

### Шаг 3: Правила, специфичные для протоколов

**Требования к HTTPS**:

```bash
# Проверка валидации сертификата
openssl x509 -text -in example.crt | grep 'Key Usage' -A1
```

- Необходимо использовать зарегистрированные платформой домены
- Длина ключа сертификата ≥2048 бит

**Ограничения TCP**:

- Поддерживаются только хосты с подстановочными знаками (`*`)
- Нет возможности терминации TLS

## Управление конфигурацией

### Операции после создания

1. Администраторы проекта могут:
   - Просматривать конфигурации шлюза
   - Создавать связанные правила маршрутизации
   - Мониторить метрики трафика
2. Проверка DNS:

```bash
dig +short <configured-domain> @8.8.8.8
```

### Ограничения обновления

- Протокол порта не может быть изменен после создания
- Изменения хоста требуют повторной проверки сертификата
- Привязка namespace неизменяемая
