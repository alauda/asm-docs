---
weight: 40
sourceSHA: 6bd39acf84e519321f7a1ccafea1a6929789218c78a3b07ba0f7898deadcd30c
---

# Операции шлюза

## Введение

Операции шлюза обеспечивают всестороннее мониторинг и возможности ведения учета, чтобы гарантировать стабильное функционирование шлюза для входящего трафика. Это касается:

- Проблем видимости состояния в реальном времени
- Усталости от оповещений через умные пороги
- Необходимости послесмертного анализа
- Требований к аудиту на соответствие

Основная ценность: Проактивное обслуживание и быстрое устранение неполадок

## Особенности

- Автообновляемая панель метрик
- Встроенные политики оповещения (ЦП/Память)
- Многоуровневое управление подробностью журнала
- Анализ шаблонов журналов доступа
- Отслеживание исторических событий

## Преимущества

**Автоматизация**: Предварительно настроенные политики мониторинга\
**Детализация**: Контроль уровня журнала по 7 уровням\
**Интеграция**: Связь с единым центром операций\
**Соответствие**: Журналы доступа, готовые к аудиту

## Мониторинг шлюза

### Доступ к метрикам в реальном времени

1. Перейдите: **Service Mesh** > **Gateway** > **Monitoring**
2. Используйте элементы управления:
   - Ручное обновление: Нажмите ![](../../../../en/trafficmanagement/ingress_gateway/assets/00metricrefresh.png)
   - Автообновление: Установите интервал через ![](../../../../en/trafficmanagement/ingress_gateway/assets/00metricautorefresh.png)
3. Просмотр деталей:
   - Переключение линий графика через ![](../../../../en/trafficmanagement/ingress_gateway/assets/00legend.png)
   - Настройка порогов с помощью ![](../../../../en/trafficmanagement/ingress_gateway/assets/33metricsetting.png)

### Ключевые метрики мониторинга

| Метрика       | Порог оповещения | Описание                    |
| -------------- | ---------------- | --------------------------- |
| Использование ЦП    | 80% (по умолчанию)   | Использование лимита ЦП пода    |
| Использование памяти | 90% (по умолчанию)   | Использование лимита памяти пода |
| QPS          | N/A             | HTTP-запросы в секунду     |
| Подключения  | N/A             | Активные TCP/HTTP сеансы    |

## Управление журналом

### Шаги конфигурации

1. Перейдите на страницу деталей шлюза
2. Обновите параметры:

| Параметр     | Опции                                       | Влияние                  |
| ------------- | ------------------------------------------- | ----------------------- |
| Журнал доступа | Включено/Выключено                          | Включает отслеживание запросов |
| Уровень журнала | trace-debug-info-warning-error-critical-off | Управление подробностью  |

### Анализ журнала доступа

Пример записи:

```
2022-10-14 [2022-10-14T09:20:59.000Z] "GET /notfound HTTP/1.1" 404 - via_upstream - "-" 0 10 14 13 "-" "curl/7.29.0" "2f76bda0-f06b-91b0-a96f-5aead910e5d3" "10.11.172.161" "10.10.0.204:80" inbound|80|| 127.0.0.6:41864 10.10.0.204:80 10.44.1.23:37652
```

Критически важные поля:

| Поле                           | Пример            | Назначение         |
| ------------------------------ | ---------------- | ------------------ |
| %RESPONSE\_CODE%              | 404              | HTTP статус        |
| %DURATION%                    | 14ms             | Время обработки    |
| %UPSTREAM\_HOST%              | 10.10.0.204:80   | Целевой бэкенд    |
| %DOWNSTREAM\_REMOTE\_ADDRESS% | 10.44.1.23:37652 | Происхождение клиента |

## Управление оповещениями

1. Предварительно настроенные политики:
   - Статус здоровья пода
   - Переиспользование ресурсов
2. Настройка уведомлений:
   - Перейдите: **Operations Center** > **Alert Policies**
   - Настройте получатели/webhooks

## Хранение и соответствие

- Хранение журналов: Установите через **Operations Center** > **Log Strategy**
- Аудиторский след: 6 месяцев по умолчанию
- Шифрование: TLS 1.2+ для передачи журналов
