---
weight: 10
sourceSHA: 6544351cfd5f70331a8e6df5eb61b0e8824d0991757325b72bafec946795d11c
---

# Глобальное ограничение скорости для сервисов

## Введение

Глобальное ограничение скорости защищает сервисы от перегрузки в условиях высокой конкуренции, обеспечивая:

- Поддержание объема запросов в пределах возможностей сервиса
- Предотвращение исчерпания ресурсов с помощью управления трафиком
- Обеспечение точного контроля доступа через условные политики

Основная ценность: Обеспечивает стабильность сервиса при максимизации использования ресурсов

## Особенности

- Глобальные и условные режимы политики
- Многоуровневое сопоставление правил (Путь/Метод/Заголовки)
- Режим теневого тестирования для проверки политики
- Панель мониторинга в реальном времени

## Преимущества

- ​**Точный контроль**: Уровень ограничения на уровне API
- ​**Снижение рисков**: Возможность пробного запуска через теневой режим
- ​**Гибкое сопоставление**: Операторы regex/равенства/неравенства
- ​**Визуальная проверка**: Мгновенная обратная связь о действительности политики

## Создание политик ограничения скорости

### Шаг 1: Доступ к интерфейсу политик

1. Перейдите: ​**Список сервисов** > ​**Целевой сервис**
2. Выберите вкладку ​**Ограничение скорости**
3. Нажмите ​**Создать политику ограничения скорости**

### Шаг 2: Выбор типа политики

| Тип                 | Ограничения                                                             |
| ------------------- | ----------------------------------------------------------------------- |
| Глобальная политика  | • Одна политика на сервис ИЛИ связь с условными политиками            |
| Условная политика   | • Допускаются несколько политик И связь между правилами                |

### Шаг 3: Настройка правил политики

**Компоненты правил**

| Категория     | Пример                | Методы сопоставления       |
| -------------- | --------------------- | -------------------------- |
| ПУТЬ API      | `/api/v1`             | Равенство/Неравенство/Regex |
| HTTP МЕТОД    | POST                  | Равенство/Неравенство     |
| Заголовки     | `User-Agent: Mobile`  | Равенство/Неравенство/Regex |

**Примечания к настройке**

- Сопоставление regex следует синтаксису RE2
- Сопоставление заголовков требует полного формата `ключ:значение`
- Несколько правил комбинируются по принципу И

### Шаг 4: Установите порог ограничения

| Параметр           | Описание                                     |
| ------------------ | -------------------------------------------- |
| Запросы/ед. времени| Максимально допустимые запросы               |
| Режим теневого тестирования | • Отключен: Применение ограничения Включен: Режим только для аудита |

## Мониторинг ограничения скорости

### Ключевые показатели

| Показатель | Режим теневого тестирования отключен | Режим теневого тестирования включен |
| ----------- | ------------------------------------ | ------------------------------------ |
| Запросы     | Фактически выполненные               | Соответствующие запросы              |
| Ограничены  | Отклоненные запросы                 | Потенциальные отклонения             |

### Интерпретация данных

1. Выберите политику из выпадающего списка
2. Выберите временной диапазон (последний 1ч/24ч/7д)
3. Сравните кривые допустимых и ограниченных запросов
4. Проверьте эффективность политики

## Управление политиками

- ​**Глобально-условные отношения**: Запросы, соответствующие любому типу политики, подлежат ограничению
- ​**Приоритет правил**: Принцип первого совпадения в условных политиках
- ​**Редактирование политики**: Немедленное действие после модификации
