---
weight: 10
sourceSHA: ece8ea9825782e4ffc1b2855960272fdaa5516da8ed4b332282c5ef172cbe9bc
---

# Изоляция Pod

## Введение

Изоляция Pod позволяет динамически исключать неисправные Pod из серверного трафика, сохраняя их рабочее состояние. Эта функциональность:

- Предотвращает сбой запросов к дефектным конечным точкам
- Поддерживает доступность сервиса во время устранения неполадок
- Позволяет бесшовную реинтеграцию после восстановления

Основная ценность: Обеспечивает непрерывную надежность сервиса через целевое управление трафиком

## Функции

- Исключение/включение Pod одним кликом
- Интеграция метрик состояния в реальном времени
- Режим совместимости для устаревших сервисов
- Неразрушающая изоляция (Pod продолжает работать)

## Преимущества

**Точность**: Целевое воздействие на конкретные Pods без перезапуска сервиса  
**Безопасность**: Сохранение кворума для оставшихся Pods  
**Видимость**: Встроенный контроль уровня успеха/задержки  
**Соответствие**: Работает в рамках оркестрации Kubernetes

## Изоляция Pods

### Шаг 1: Доступ к управлению Pod

1. Перейдите в: **Список сервисов** > **Целевой сервис**
2. Выберите вкладку **Группа Pod**
3. Найдите целевой Pod через метрики или логи

### Шаг 2: Выполнение изоляции

```yaml
# Аннотация состояния изоляции
metadata:
  annotations:
    asm.cpaas.io/isolated: "true"
```

| UI-управление                                                            | Действие                 |
| ------------------------------------------------------------------------- | ------------------------ |
| ![](../../../../en/trafficmanagement/isolate_pod/assets/333point.png)     | Открыть контекстное меню  |
| **Установить изоляцию**                                                  | Переключить состояние изоляции |
| **Установить**                                                            | Подтвердить конфигурацию  |

## Активация устаревшего сервиса

### Контрольный список требований

- Kubernetes версии v1.18+
- Сервис, созданный до выпуска функции изоляции
- Привилегии администратора кластера

### Обновление конфигурации

1. Измените метки развертывания:

```yaml
metadata:
  labels:
    asm.cpaas.io/msselector: product-service
```

2. Обновите внутренний селектор маршрута:

```yaml
spec:
  selector:
    asm.cpaas.io/msselector: product-service
```

## Мониторинг и валидация

### Панель ключевых метрик

| Метрика             | Порог         | Элементы управления обновлением                                                                  |
| ------------------- | ------------- | ----------------------------------------------------------------------------------------------- |
| Уровень ошибок      | \<5%          | ![](../../../../en/trafficmanagement/isolate_pod/assets/33metricrefresh.png)                   |
| Задержка            | \<500ms       | ![](../../../../en/trafficmanagement/isolate_pod/assets/33metricautorefresh.png)              |
| Активные подключения | ±10% отклонение | ![](../../../../en/trafficmanagement/isolate_pod/assets/33legend.png)                         |

### Проверка статуса

```bash
kubectl get endpoints <название-сервиса> -o jsonpath='{.subsets[].notReadyAddresses}'
```

## Операционные ограничения

1. **Ограничения по состоянию**:
   - Влияет только на Pods в состоянии Запущен
   - Исключает Pods в режиме Завершен/CrashLoopBackOff

2. **Сценарии конфликта**:
   - Отключено во время канареечных релизов
   - Перекрывается событиями масштабирования (scale-in/scale-out)

3. **Устойчивость**:
   - Изоляция сбрасывается при перезапуске Pod
   - Требуется ручная повторная изоляция после восстановления
