---
weight: 10
sourceSHA: e600efe8fca8aa0ba707b8dbf78767eecbdddef2087b27607c58bee6ca5e04c1
---

# Управление конфигурацией Sidecar

## Введение

Конфигурация Sidecar позволяет точно контролировать поведение прокси Envoy в сервисных сетях Istio. Эта функциональность:

- Определяет масштаб выполнения политик трафика
- Оптимизирует использование ресурсов прокси
- Реализует контроль доступа на уровне пространств имен
- Поддерживает иерархические стратегии конфигурации

Основная ценность: балансировка производительности сервисной сети и безопасности через детализированное управление трафиком

## Возможности

- Конфигурация по умолчанию на уровне кластера
- Пользовательские правила для конкретных пространств имен
- Шаблоны совпадений с подстановочными знаками
- Механизм переопределения приоритета

## Преимущества

**Оптимизация производительности**: снижение накладных расходов на обработку прокси  
**Контроль безопасности**: ограничение области воздействия сервиса  
**Гибкость**: множество шаблонов совпадений по пространствам имен  
**Совместимость**: полная поддержка API Istio

## Управление конфигурацией по умолчанию

### Параметры конфигурации

| Параметр    | Формат            | Пример          |
| ------------ | ----------------- | ---------------- |
| Egress Hosts | пространство/nombreDNS | `istio-system/*` |

### Процесс обновления

1. Перейдите в: **Сервисная сеть** > **Сети**
2. Выберите целевую сеть > вкладка **Конфигурация Sidecar**
3. Найдите кластер > нажмите на значок редактирования ![](../../../../en/trafficmanagement/sidecar_configuration/assets/00pencil.png)
4. Настройте выходные хосты:
   - Выберите пространство имен из выпадающего меню
   - Выберите шаблон:
     - `*/*` По всему кластеру
     - `./*` Текущее пространство имен
     - Пользовательское пространство имен
5. Нажмите **Подтвердить**

**Ограничения**:

- Должно находиться в пространстве имен `istio-system`
- Влияет на все пространства имен без пользовательской конфигурации

## Настройка пользовательской конфигурации

### Шаблон конфигурации

```yaml
apiVersion: networking.istio.io/v1beta1
kind: Sidecar
metadata:
  name: ns-custom
  namespace: target-ns
spec:
  egress:
  - hosts:
    ◦ "dev/*"
    ◦ "prod/db-service"
```

### Этапы реализации

1. Получите доступ к странице деталей сети
2. Перейдите в вкладку **Конфигурация Sidecar**
3. Нажмите **Создать конфигурацию Sidecar**
4. Выберите целевое пространство имен
5. Настройте шаблоны выходных хостов:
   - Используйте подстановочный знак `*` для широкого соответствия
   - `.` представляет текущее пространство имен
6. Проверьте переопределение приоритета

## Примеры конфигурации

### Пример 1: Изоляция пространства имен

```yaml
apiVersion: networking.istio.io/v1beta1
kind: Sidecar
metadata:
  name: ns-prod
  namespace: prod
spec:
  egress:
  - hosts:
    ◦ "prod/*"  # Текущее пространство имен
    ◦ "monitoring/*"  # Конкретное пространство имен
```

### Пример 2: Полный доступ к кластеру

```yaml
apiVersion: networking.istio.io/v1beta1
kind: Sidecar
metadata:
  name: default
  namespace: istio-system
spec:
  egress:
  - hosts:
    ◦ "*/*"  # Все пространства имен
```

## Спецификации параметров

| Параметр | Обязательность | Тип   | Описание                                      |
| --------- | -------- | ------ | ------------------------------------------------ |
| namespace | Да      | Строка | Должен быть `istio-system` для конфигурации по умолчанию        |
| egress    | Да      | Массив  | Содержит массив шаблонов хостов                    |
| hosts     | Да      | Массив  | Формат `namespace/nombreDNS` с поддержкой подстановочных знаков |

## Операционные ограничения

1. **Связывание пространства имен**:
   - Пользовательские конфигурации влияют только на назначенное пространство имен
   - Конфигурация по умолчанию требует пространство имен `istio-system`

2. **Правила шаблонов**:
   - Подстановочный знак (\*) разрешен только в самом левом компоненте DNS
   - `prod/*.svc.cluster.local` соответствует сервисам prod

3. **Задержка обновлений**:
   - Изменения конфигурации вступают в силу в течение 60 секунд
   - Требует контрольную плоскость Istio 1.9+
