---
weight: 15
i18n:
  title:
    en: Installation
    ru: Установка
sourceSHA: dafe2339c1ed2579a179c5a32a18e0c8269b51c39a1266f375a534ecf9d9d69c
---

# Установка

В данной статье будут использованы два кластера AWS EKS (Amazon Elastic Kubernetes Service) — c1 и c2, расположенные в разных VPC (Виртуальных Частных Облаках), в качестве примеров для иллюстрации того, как построить многокластерную, многоуровневую сервисную сетку.

:::note

Для демонстрационных целей в этой статье выбраны только два кластера для построения сетки. На практике вы можете добавить больше кластеров, соответствующих предварительным требованиям, в сервисную сетку в зависимости от ваших потребностей.

:::

## Предварительные требования

- Для частных облаков убедитесь, что Kubernetes LoadBalancer (например, MetaLB) настроен во всех кластерах для обеспечения возможностей балансировки нагрузки для шлюзов Istio, развернутых в кластерах.
- Все кластеры были подключены к платформе.
- Компоненты мониторинга были развернуты для всех кластеров через <ExternalSiteLink name="acp" href="/observability/monitor/functions/install_monitor.html#install-the-acp-monitoring-with-victoriametrics-plugin" children="Развернуть компонент мониторинга" />, включая **VictoriaMetrics**. <br />Чтобы обеспечить агрегирование данных мониторинга из нескольких кластеров, убедитесь, что данные мониторинга из нескольких кластеров, которые должны быть добавлены в сетку, могут быть собраны в один и тот же Центр VictoriaMetrics с одним и тем же адресом запроса данных.
  **Примечание**: Проверено, **VictoriaMetrics** хорошо поддерживает **архитектуру с несколькими мастер-узлами** для сервисной сетки. Для поддержки других решений мониторинга, пожалуйста, свяжитесь с технической поддержкой.
- Все **контрольные узлы** и **устройства балансировки нагрузки** (если есть) во всех кластерах должны иметь открытый порт `6443` для kube-apiserver, а порт `6443` устройства балансировки нагрузки должен перенаправлять трафик на порт `6443` контрольного узла.
- Убедитесь, что версия Kubernetes кластеров совместима с версией Istio, поддерживаемой платформой. Для получения подробной информации смотрите [Поддерживаемые версии Kubernetes для Istio](https://istio.io/latest/docs/releases/supported-releases/).

## Создание сервисной сетки

Выберите один из подготовленных кластеров и создайте сервисную сетку.

При создании сетки настройте соответствующие параметры следующим образом и при необходимости настройте другие параметры:

- Разверните Istio для сетки.
- Выберите `Многокластерное` для **Архитектуры сетки**.
- Выберите `Многоуровневую` для **Типа сети**.
  **Примечание**: Платформа автоматически развернет шлюзы восточо-западного трафика для всех кластеров, присоединяющихся к сетке, соединяя сети между кластерами.
- Интегрируйтесь с компонентами мониторинга, предоставляемыми `платформой`, для **Системы мониторинга**.

## Добавление кластеров

1. В левой панели навигации нажмите **Сервисная сетка** > **Сетка**.
2. Нажмите на ***Имя сервисной сетки*** кластера, который нужно добавить.
3. На вкладке **Подробности сетки**, в разделе **Развертывание сетки**, нажмите **Добавить кластер**.
4. В разделе **Основная информация** выберите кластер для присоединения к сервисной сетке.
5. Настройте конфигурацию сетки и компоненты на уровне кластера в соответствии с фактическими требованиями развертывания.
6. Нажмите **Добавить**.

   **Примечание**:

   - После успешного добавления система последовательно развернет компоненты, связанные с сервисной сеткой, на кластере. Нажмите <img src="../../en/multicluster_mesh/assets/show_status.png" style={{display: "inline", verticalAlign: "middle"}} /> в разделе **Развертывание сетки**, чтобы просмотреть ход развертывания.

   - После добавления кластера глобальная конфигурация сетки (система мониторинга, конфигурация интеграции с Elasticsearch) будет автоматически синхронизироваться с только что добавленным кластером.
