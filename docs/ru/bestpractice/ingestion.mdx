---
weight: 11
title: Интеграция наблюдаемых данных OpenTelemetry в платформу
description: >-
  Этот документ объясняет, как интегрировать наблюдаемые данные OpenTelemetry в
  платформу, включая конфигурацию приемников OTel Collector и интеграцию
  собственных разработанных сервисов или внешнего программного обеспечения,
  поддерживающего OpenTelemetry, что позволяет использовать возможности
  визуализации данных платформы.
sourceSHA: b81a4da44ba61539100d33cf3b4e3b451d612447ac759bcc185286a77b612101
---

## Обзор

Текущий продукт предоставляет возможности мониторинга метрик и распределенного трассирования для Java-сервисов через OTel Java Agent. Кроме того, пользователи могут интегрировать наблюдаемые данные из сервисов, разработанных с использованием OTel SDK, или из систем, совместимых с OpenTelemetry (таких как Harbor и GitLab), в платформу, используя её возможности визуализации данных.

Этот документ предназначен для того, чтобы помочь пользователям интегрировать эти наблюдаемые данные в платформу.

## Предварительные требования

Убедитесь, что в кластере, где находятся сервисы или системы, развернута сервисная сетка.

## Шаги

### 1. Настройка приемников OTel Collector

Приемники OTel Collector отвечают за получение и разбор данных из различных источников. В зависимости от источника данных и протокола интеграции OTel Collector предлагает несколько приемников.

Вот **по умолчанию включенные** приемники на платформе и сценарии их использования:

#### Приемник OTLP

OTLP (OpenTelemetry Protocol) — это стандартный протокол, рекомендованный OpenTelemetry для получения данных о трассировании, метриках и логах, поддерживающий транспортные протоколы gRPC и HTTP.

| Протокол | Адрес кластера                          |
| -------- | --------------------------------------- |
| HTTP     | asm-otel-collector.cpaas-system:4318   |
| GRPC     | asm-otel-collector.cpaas-system:4317   |

#### Приемник Zipkin

Приемник Zipkin используется для получения данных о трассировании в формате Zipkin, поддерживающий транспортный протокол HTTP от клиентов Zipkin.

| Протокол | Адрес кластера                          |
| -------- | --------------------------------------- |
| Zipkin   | asm-otel-collector.cpaas-system:9411   |

---

- **Как выбрать подходящий приемник?**

  1. Подтвердите типы данных, которые необходимо собирать (трассирование, метрики, логи), и поддерживаемые протоколы.

  2. На основе форматов данных и транспортных протоколов, используемых внешними сервисами, выберите подходящий приемник из списка поддерживаемых приемников OTel Collector на платформе.

### 2. Интеграция данных в платформу

#### Собственные разработанные сервисы

Интегрируйте OpenTelemetry SDK для отправки наблюдаемых данных (таких как трассирование, метрики и логи), генерируемых вашими сервисами, в OTel Collector. Конкретные шаги следующие:

1. Импортируйте OpenTelemetry SDK.
2. Инициализируйте OpenTelemetry.
3. Генерируйте и отправляйте данные трассировки.

Сообщество OpenTelemetry предоставляет примеры использования SDK для различных языков; пожалуйста, обратитесь к официальной документации:

- [Пример Java](https://opentelemetry.io/docs/languages/java/getting-started/)
- [Пример Golang](https://opentelemetry.io/docs/languages/go/getting-started/)

#### Интеграция наблюдаемого программного обеспечения

Внешние сервисы (такие как GitLab и Harbor) обычно уже обладают возможностями экспорта данных. Вы можете обратиться к соответствующей документации программного обеспечения для конкретных методов конфигурации.

В конфигурации необходимо указать адрес приемника для OTel Collector следующим образом:

1. Если программное обеспечение развернуто в том же кластере, что и сервисная сетка:
   - Подтвердите, что необходимый приемник включен на платформе.
   - Для полного списка поддерживаемых приемников, пожалуйста, обратитесь к [Списку поддерживаемых приемников платформы](distributed_tracing/how_to/otel_collector_config.html#receivers).

2. Если программное обеспечение не может получить доступ к OTel Collector напрямую по адресу кластера, возможно, вам потребуется настроить балансировщик нагрузки для обеспечения доступа внешнего сервиса. Пожалуйста, свяжитесь с вашим администратором для дальнейшей конфигурационной помощи.

### 3. Проверка интеграции данных

1. Запустите внешний сервис и проведите соответствующие тесты для генерации данных трассировки.

2. Проверьте, были ли данные трассировки успешно получены и обработаны OTel Collector на платформе.
   - Используйте функцию **Трассирование** платформы для запроса данных о распределенном трассировании, чтобы проверить успешность интеграции внешних данных.
