---
weight: 10
title: Описание ресурсов микросервиса
sourceSHA: 899df71541f10ba52d6b9391a5e8823fc9f44be143787d99c79710ab194e026e
---

Этот документ в основном предоставляет описание ресурсов для микросервисов типа ServiceMesh.

### <span id="ms">Справочник ресурсов микросервиса</span>

#### **Пример YAML**

```yaml
apiVersion: asm.alauda.io/v1beta3
kind: MicroService
metadata:
  labels:
    app.cpaas.io/microservice-type: service-mesh
  name: xqren-s1
  namespace: xqren-ovn
spec:
  accessLogging:
    enabled: true
  auth:
    enabled: true
  deployments:
    - name: asm-test-image
  otelJavaAgent:
    enabled: false
  services:
    - name: xqren-s1
  sidecar:
    enabled: true
    cpuLimit: '0.1'
    memoryLimit: 256Mi
    envoyLogLevel: warning
```

#### **Параметры верхнего уровня**

| Название параметра | Обязательный | Тип    | Описание                                                                                                                                                 |
| ------------------ | ------------ | ------ | ------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **apiVersion**     | Да           | строка | Версия API, должна быть `asm.alauda.io/v1beta3`.                                                                                                           |
| **kind**           | Да           | строка | Тип объекта ресурса, должен быть `MicroService`.                                                                                                        |
| **metadata**       | Да           | объект | Метаданные службы, включая имя службы (name), пространство имен (namespace), метки (labels) и аннотации (annotations).                                 |
| **[spec](#spec)**  | Да           | объект | Подробная информация о службе, включая параметры конфигурации службы, такие как журналы доступа, Sidecar, Java-агент OpenTelemetry, развертывание и т. д. |

#### <span id="spec">**Параметры spec**</span>

- <span id="dep">**deployments**</span>

  **deployments** используется для указания развертывания, выполняющего службу. Развертывание должно находиться в том же пространстве имен, что и служба.

  | Название параметра | Обязательный | Описание                                             |
  | ------------------ | ------------ | --------------------------------------------------- |
  | **name**           | Да           | Имя развертывания, связанного со службой.           |

- <span id="svc">**services**</span>

  **services** используется для описания службы, связанной **один к одному** с [развертываниями](#dep).

  **Служба** должна соответствовать следующим условиям:

  - Со службой связано только одно развертывание, и служба связана только с выбранным развертыванием.

  - Тип службы **NodePort** или **ClusterIP**.

  - Служба поддерживает протоколы HTTP, HTTP2, gRPC и TCP.

  | Название параметра | Обязательный | Описание              |
  | ------------------ | ------------ | --------------------- |
  | **name**           | Да           | Имя службы.          |

- **accessLogging**

  **accessLogging** используется для управления тем, следует ли собирать и выводить журналы доступа (access log) веб-сервисов, обращающихся к текущей службе, в журналах.

  \| Название параметра  | Обязательный |  Описание |
  \|---------------------|--------------|------------|
  \| **enabled**         | Нет         |  Собираются ли и выводятся ли журналы доступа (access log) веб-сервисов, обращающихся к текущей службе. |

- **auth**

  **auth** используется для управления тем, вступили ли в силу правила черного и белого списка, настроенные для службы.

  \| Название параметра | Обязательный |  Описание |
  \|--------------------|--------------|------------|
  \| **enabled**        | Нет         | Действуют ли правила черного и белого списка, по умолчанию отключены. |
