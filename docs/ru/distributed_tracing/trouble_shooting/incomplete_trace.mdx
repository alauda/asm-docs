---
weight: 20
sourceSHA: 17b34bbef5d0b2a7beec2cab0b8252b856b2fc046a716ad5e0ea8f7243fd447c
---

# Неполные данные трассировки

## Описание проблемы

Результаты запросов трассировки имеют следующие проблемы с неполными данными:

- В последних запросах (в течение последних 30 минут) отсутствуют некоторые интервалы.
- Данные трассировки старше 1 часа испытывают разрывы соединения.

## Анализ коренной причины

### 1. Задержка хранения данных

Процесс записи в Elasticsearch требует выполнения последовательности шагов, включая буфер памяти → журнал транзакций → файлы сегментов, что может привести к задержкам видимости для недавно записанных данных.

### 2. Ограничение по времени

По умолчанию, когда `jaeger-query` запрашивает интервалы, соответствующие трассам, диапазон времени охватывает один час до и после времени начала интервала.

Например, если интервал начинается в `08:12:30` и заканчивается в `08:12:32`, диапазон времени для запроса этой трассы составит с `07:12:30` до `09:12:32`.

Таким образом, если трасса занимает более 1 часа, запрос через этот интервал может не дать полной трассы.

## Решение для коренной причины 1

Подождите немного и обновите страницу, чтобы повторить запрос.

## Решение для коренной причины 2

Если интервал трассировки в вашей среде длительный, вы можете настроить диапазон времени запроса для одной трассы, используя параметр запуска `--es.asm.span-trace-query-time-adjustment-hours` в `jaeger-query`.

Значение по умолчанию для этого параметра составляет `1` час, и вы можете увеличить это значение по мере необходимости.
