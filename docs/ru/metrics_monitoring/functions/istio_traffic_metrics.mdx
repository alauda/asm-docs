---
weight: 10
sourceSHA: 449f88a556571358e4906217ace3d8d36de07435d373d495af9fd3965b33ca53
---

# Метрики трафика Istio

Платформа предлагает множество данных о метриках трафика, что позволяет пользователям анализировать качество трафика сервисов с разных точек зрения.

## Предварительные условия

Сервис был инжектирован с помощью Sidecar, подробности см. в [Добавление сервисов](../../microservice/add-service.md#add-servicemesh-service).

## Быстрый старт

1. В левом навигационном меню нажмите **Мониторинг**.
2. Выберите сервис, для которого хотите просмотреть данные мониторинга, и диапазон времени.

   **Примечание**: Диапазон времени запроса ограничен периодом хранения данных мониторинга Prometheus. Например, если данные мониторинга хранятся до 7 дней, а установленный диапазон времени – последние 30 дней, статистические данные охватывают только 7 дней.
3. Нажмите соответствующие вкладки, чтобы просмотреть данные мониторинга трафика и данные мониторинга API для сервиса.

   **Объяснение**: Когда сетевой слой сервисов управляет несколькими кластерами, и есть **сервисы с одинаковым пространством имен и именем** (сервисы без протокола Dubbo) в нескольких кластерах, панель мониторинга трафика отображает агрегированные данные мониторинга сервисов по всем кластерам.<br />Используйте панель **Сравнение трафика по кластерам**, чтобы сравнить данные мониторинга сервиса в каждом кластере.

## Мониторинг трафика сервиса

### Обычные операции

- **Обновить данные**: Статистика мониторинга на текущей странице автоматически обновляется только один раз при открытии страницы. Чтобы обновить снова, вы можете использовать два следующих метода:

  - Ручное обновление: Нажмите <img src="../../../en/metrics_monitoring/assets/metric_refresh.png" style={{display: "inline", verticalAlign: "middle"}} /> в правом нижнем углу страницы для ручного обновления данных.

  - Установить автоматическое обновление (по умолчанию выключено): Нажмите <img src="../../../en/metrics_monitoring/assets/metric_auto_refresh.png" style={{display: "inline", verticalAlign: "middle"}} /> для установки интервала автоматического обновления данных.

- **Просмотр/установка легенды**: Нажмите <img src="../../../en/metrics_monitoring/assets/legend.png" style={{display: "inline", verticalAlign: "middle"}} /> в правом верхнем углу графика, чтобы развернуть легенду в графике мониторинга. Нажмите на легенду, чтобы скрыть/показать соответствующую кривую на графике.

- **Просмотр графика мониторинга в большом размере**: Нажмите <img src="../../../en/metrics_monitoring/assets/big_chart.png" style={{display: "inline", verticalAlign: "middle"}} /> в правом верхнем углу графика, чтобы просмотреть увеличенный и более подробный график мониторинга в всплывающем окне.

### Объяснение данных мониторинга

#### HTTP/HTTP2/gRPC, протоколы Dubbo

| Метрики мониторинга                | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| --------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Среднее время ответа**         | Среднее время ответа в пределах запрашиваемого диапазона времени (общее время ответа/общее количество ответов).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **Средний входящий/исходящий RPS** | Среднее значение входящего/исходящего RPS (запросов в секунду) в пределах запрашиваемого диапазона времени.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **Время ответа**                 | Время ответа между сервисами или внутри самого сервиса, отображается как среднее, TP 50, TP 95, TP 99.<br />TP (Top Percentile) xx указывает на минимальную длительность, необходимую для xx процентов сетевых запросов, часто используется в сценариях мониторинга производительности систем.<br />Наведите курсор на кривую, чтобы просмотреть время ответа за определенный период.                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **Входящий/исходящий RPS**         | Общее количество входящего/исходящего трафика RPS и ошибочного входящего/исходящего трафика RPS в пределах запрашиваемого диапазона времени.<br />**RPS = Количество запросов за время запроса / Длительность запроса (с)**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Входящий/исходящий трафик**     | Общее количество входящих/исходящих запросов в пределах запрашиваемого диапазона времени, а также пропорция трафика по HTTP-кодам возврата (нормальный/2xx, 3xx, 4xx, 5xx).<br />Наведите курсор на столбчатую диаграмму, чтобы просмотреть пропорцию трафика по каждой категории.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **Сравнение трафика клиента**     | **Клиент** относится к клиентскому сервису (низший сервис), который делает запросы к текущему сервису (высший сервис). **Сравнение трафика клиента** будет сравнивать и отображать **Время ответа**, **Входящий RPS** и входящую **Ставку ошибок RPS** (Ошибка RPS/RPS) различных клиентов, обращающихся к текущему сервису.<br /><br />**Объяснение**:<br />- **Неизвестный клиент** относится к сбору клиентов (HTTP-протокол) внутри сервисной сети, которые обращаются к текущему сервису и чей трафик не управляется Sidecar.<br />- Если клиент принадлежит текущему пространству имен, нажав **Трассировка** рядом с именем клиента, вы будете перенаправлены на страницу трассировки.<br />- Когда в канаре выпуске сервиса есть две версии, отображаются агрегированные данные обеих версий. |

#### Протокол TCP

| Метрики мониторинга                    | Описание                                                                                                                                                                                                                                                                       |
| ------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Входящий/исходящий трафик**         | Размер потока байтов входящего и исходящего трафика в пределах запрашиваемого диапазона времени.                                                                                                                                                                                                    |
| **Средний входящий/исходящий трафик** | Среднее значение входящего/исходящего трафика (трафик/длительность) в пределах запрашиваемого диапазона времени.                                                                                                                                                                                        |
| **Входящий/исходящий**                 | Скорость передачи потока байтов входящей и исходящей сетевой службы (байтов в секунду).                                                                                                                                                                                        |
| **TCP-соединения**                   | Общее количество соединений.<br />**Ставка ошибок** = Количество неудавшихся соединений / Общее количество соединений<br />**Ставка успеха** = Количество успешных соединений / Общее количество соединений<br />Наведите курсор на столбчатые графики разных цветов, чтобы просмотреть количество соединений в каждой категории. |
| **Сравнение трафика клиента**         | Сравнивает скорость передачи сетевого входящего потока байтов между сервисом и клиентскими сервисами, обращающимися к текущему сервису.                                                                                                                                            |

## Мониторинг трафика API

Чтобы обеспечить производительность системы мониторинга, сначала вам нужно [задекларировать API сервиса](./create_api.mdx) на платформе. В дальнейшем платформа будет отличать качество трафика объявленного API в метриках трафика сервиса.

После успешного объявления API сервиса вы сможете выбрать API под этим сервисом во вкладке мониторинга трафика API.

### Объяснение данных мониторинга

**Совет**: Во время просмотра данных вы можете обратиться к [Обычным операциям](#обычные-операции), чтобы обновить данные мониторинга или скрыть данные, соответствующие легенде.

- Среднее время ответа: Среднее время ответа в пределах выбранного диапазона времени (общее время ответа/общее количество ответов).

- Время ответа: Отображается как среднее, TP 50, TP 95, TP 99. Поддерживает просмотр времени ответа для одного значения. Наведите курсор на кривую, чтобы просмотреть время ответа за определенный период.
  TP xx указывает на минимальную длительность, необходимую для xx процентов сетевых запросов, часто используется в сценариях мониторинга производительности систем.

- Средний входящий RPS: Среднее значение RPS в пределах выбранного диапазона времени.

- Входящий RPS: Запросы в секунду, отображая кривую трафика. Поддерживает просмотр общего трафика RPS или нажмите, чтобы выбрать ошибочный трафик RPS.

- Трафик: Отображает общее количество посещений, среднюю ставку успеха и среднюю ставку ошибок в пределах выбранного диапазона времени. Цвета представляют различные коды состояния HTTP: темно-зеленый для успешного состояния (2XX), светло-зеленый для перенаправления (3XX), оранжевый для ошибок клиентских запросов (4XX) и красный для ошибок сервера (5XX). Средняя ставка ошибок = (4XX+5XX) / общий трафик × 100%.
