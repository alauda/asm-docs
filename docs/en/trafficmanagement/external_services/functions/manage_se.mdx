---
weight: 10
---

# External Service Management

## Introduction
Enables integration of non-mesh services into service mesh governance to:

- Solve hybrid cloud connectivity challenges
- Manage traffic for legacy systems
- Implement secure egress control

Core value: Unified policy enforcement for internal/external services

## Features
• Layer 4/7 protocol support
• Egress gateway binding
• DNS/VIP address registration
• Multi-port configuration

## Advantages
- Protocol consistency across environments
- Namespace-level traffic isolation
- Fixed protocol after creation
- 5-port maximum per service

## Creating External Services

### Step 1: Basic Configuration
1. Navigate: **Service Mesh** > **External Services**
2. Select target cluster
3. Click **Add External Service**

| Parameter | Requirement | Description |
|-----------|-------------|-------------|
| Service Protocol | Required | HTTP/HTTPS/TCP |
| Service Address | Required | Domain/VIP for L7, IP list for L4 |
| Service Ports | Required | Max 5 ports |

### Step 2: Egress Gateway Binding
1. Toggle **Bind Egress Gateway**
2. Configure parameters:

| Parameter | Value Example | Constraint |
|-----------|---------------|------------|
| Namespace | istio-system | Must exist |
| Assigned Port | 80:HTTP | Protocol match |
| Bind Namespace | All/Custom | Sidecar required |

### Step 3: Request Rewriting
Configuration Example:
• Original: `http://www.example.com:80`
• Target: `www.example123.com:8080/v1/service1`

---

# Load Balancing Policy Configuration

## Introduction
Optimizes traffic distribution for external services by:

- Preventing endpoint overload
- Maintaining session consistency
- Enabling protocol-specific tuning

Core value: 99.9% availability assurance

## Features
• 4 load balancing algorithms
• HTTP header/source IP/cookie persistence
• Health check integration
• Protocol-specific optimization

## Advantages
- Session continuity for stateful services
- Automatic failover mechanism
- L4/L7 protocol awareness
- GDPR-compliant routing

## Policy Creation Steps

### Step 1: Access Policy Interface
1. Select target external service
2. Navigate: **Policy** > **Create Policy** > **Load Balancing**

### Step 2: Algorithm Selection
| Algorithm | Protocol Support | Description |
|-----------|------------------|-------------|
| Least Request | HTTP/HTTPS | Select from 2 healthy instances |
| Random | TCP/HTTP | Random distribution |
| Round Robin | TCP/HTTP | Cyclic distribution |
| Session | HTTP/HTTPS | Session persistence |

### Step 3: Session Configuration
**HTTP Header Persistence**
| Parameter | Example |
|-----------|---------|
| Header Name | User-Agent |

**Cookie Settings**
| Parameter | Requirement |
|-----------|-------------|
| name | Required |
| ttl | 300-3600 seconds |

---

# Circuit Breaker Policy Implementation

## Introduction
Protects services by:

- Automatically isolating faulty endpoints
- Limiting concurrent connections
- Managing request retries

Core value: Prevents cascading failures

## Features
• 5xx error detection
• Dynamic isolation duration
• Connection pool limits
• Partial recovery mechanism

## Advantages
- Progressive host reintroduction
- HTTP/2 protocol optimization
- Built-in health monitoring
- 80% failure reduction

## Policy Configuration

### Step 1: Access Policy Interface
1. Select target service
2. Navigate: **Policy** > **Create Policy** > **Circuit Breaker**

### Step 2: Threshold Settings
| Parameter | Default | Impact |
|-----------|---------|--------|
| Consecutive Errors | 5 | Sensitivity |
| Check Interval | 30s | Detection frequency |
| Base Isolation | 1m | Initial isolation |
| Max Isolation | 30% | Safety threshold |

### Step 3: Verification
Platform Auto-check Process:
1. Regular health checks (every 30s)
2. Faulty instance isolation (max 30%)
3. Progressive isolation duration
4. Automatic recovery mechanism

